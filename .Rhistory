x = seq(4,15,0.1)
ip = read.delim('ip_all.bed.peaks', header = FALSE)
y = c()
for (i in x) {y=c(y,nrow(ip[ip$V5 > i,]))}
plot(x,y)
x = seq(4,15,0.1)
ip = read.delim('control_all.bed.peaks', header = FALSE)
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,]))}
plot(x,y)
x = seq(4,15,0.1)
control = read.delim('control_all.bed.peaks', header = FALSE)
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,]))}
plot(x,y)
y = c()
for (i in x) {y=c(y,(nrow(control[control$V5 > i,] / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100)}
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,] / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100)}
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100)}
plot(x,y)
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,]) / nrow(ip[ip$V5 > i,]) * 100)}
plot(x,y)
ip = read.delim('ip_all.bed.peaks', header = FALSE)
control = read.delim('control_all.bed.peaks', header = FALSE)
y = c()
for (i in x) {y=c(y,nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100)}
plot(x,y)
y = c()
x = seq(4,10,0.1)
for (i in x) {y=c(y,nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100)}
plot(x,y)
nrow(ip[ip$V5 > 6,])
?plot
plot(x,y, ylab="FDR", xlab="Peak score")
plot(x,y, ylab="FDR", xlab="Peak score", ylim=(0,5))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5), char=19)
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5), char="19")
?plot
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,1))
nrow(ip[ip$V5 > 6,])
nrow(ip[ip$V5 > 7,])
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,1))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,10))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,20))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,25))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,25))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5))
nrow(ip[ip$V5 > 5.5,])
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,5))
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,1))
nrow(ip[ip$V5 > 7,])
ip_FDR_0.01 = ip[ip$V5 > 7,]
write.table(ip_FDR_0.01, file="mtb_peaks_pypeak_200_4_FDR1.bed", sep='\t', row.names=FALSE, col.names=FALSE)
i = 7
nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
i = 8
nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
i = 9
nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
i = 20
nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
nrow(ip[ip$V5 > 7.5,])
nrow(ip[ip$V5 > 8,])
nrow(ip[ip$V5 > 6,])
nrow(ip[ip$V5 > 5,])
pdf(file="FDR_plot.pdf")
nrow(ip[ip$V5 > 5.1,])
nrow(ip[ip$V5 > 5,])
plot(x,y, ylab="FDR", xlab="Peak score", ylim=c(0,1))
dev.off()
nrow(ip[ip$V5 > 10,])
nrow(ip[ip$V5 > 8,])
> i = 20
> nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
nrow(control[control$V5 > i,]) / (nrow(control[control$V5 > i,]) + nrow(ip[ip$V5 > i,])) * 100
history
history(30)
write.table(ip_FDR_0.01, file="mtb_peaks_pypeak_200_4_FDR1.bed", sep='\t', row.names=FALSE, col.names=FALSE)
head(ip_FDR_0.01)
const =  ip_FDR_0.01[,-4]
head(const)
write.table(const, file="mtb_peaks_pypeak_200_4_FDR1_const.bed", sep='\t', row.names=FALSE, col.names=FALSE)
nrow(ip[ip$V5 > 8,])
nrow(ip[ip$V5 > 5,])
nrow(ip[ip$V5 > 6,])
q()
